<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan de Mejora - IES Virgen de Villadiego</title>
    
    <!-- Meta tags para PWA -->
    <meta name="theme-color" content="#0d6efd">
    <meta name="description" content="Aplicación para gestionar el Plan de Mejora del IES Virgen de Villadiego">
    <meta name="keywords" content="educación, plan mejora, IES, Villadiego">
    <meta name="author" content="IES Virgen de Villadiego">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Plan de Mejora">
    
    <!-- Windows Meta Tags -->
    <meta name="msapplication-TileColor" content="#0d6efd">
    <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon y iconos -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#0d6efd">

    <style>
        :root {--primary-color: #0d6efd; --secondary-color: #6c757d; --accent-color: #198754;}
        body {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8f9fa; margin: 0; padding: 0; overflow-x: hidden;}
        .welcome-screen {position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, var(--primary-color), #4a00e0); color: white; cursor: pointer; transition: all 0.5s ease; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; padding: 20px; text-align: center;}
        .welcome-screen.hidden {display: none;}
        .welcome-screen:hover {background: linear-gradient(135deg, #4a00e0, var(--primary-color));}
        .app-container {display: none; padding: 20px 0;}
        .app-container.visible {display: block;}
        .filter-section, .config-section, .report-section {background-color: white; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px;}
        .filter-toggle, .config-toggle, .report-toggle {cursor: pointer; color: var(--primary-color); font-weight: bold; margin-bottom: 15px; display: flex; align-items: center;}
        .filter-toggle:hover, .config-toggle:hover, .report-toggle:hover {text-decoration: underline;}
        .filter-content, .config-content, .report-content {overflow: hidden; transition: max-height 0.3s ease;}
        .filter-content.collapsed, .config-content.collapsed, .report-content.collapsed {max-height: 0;}
        .propuesta-card {background-color: white; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); padding: 20px; margin-bottom: 20px; transition: transform 0.3s ease, box-shadow 0.3s ease; border-left: 4px solid var(--primary-color);}
        .propuesta-card:hover {transform: translateY(-5px); box-shadow: 0 6px 12px rgba(0,0,0,0.1);}
        .propuesta-id {font-weight: bold; color: var(--primary-color); font-size: 1.1rem;}
        .indicador-item {background-color: #f8f9fa; border-radius: 5px; padding: 10px; margin-bottom: 10px;}
        .responsable {font-weight: bold; color: var(--accent-color);}
        .area-title {color: var(--primary-color); border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; margin-bottom: 20px; font-size: 1.5rem;}
        .factor-title {color: var(--secondary-color); font-size: 1.1rem; margin-top: 20px; cursor: pointer; text-decoration: underline; padding: 10px 0;}
        .factor-title:hover {color: var(--primary-color);}
        .no-results {text-align: center; padding: 40px; color: var(--secondary-color);}
        .back-to-top {position: fixed; bottom: 20px; right: 20px; background-color: var(--primary-color); color: white; border: none; border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 1000; opacity: 0; transition: opacity 0.3s;}
        .back-to-top.visible {opacity: 1;}
        .estado-propuesta {margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;}
        .estado-check {margin-right: 15px;}
        .estado-label {margin-right: 10px; font-weight: normal;}
        .estado-no-iniciada {color: #dc3545;}
        .estado-en-proceso {color: #ffc107;}
        .estado-conseguida {color: #198754;}
        .indicadores-toggle {cursor: pointer; color: var(--primary-color); font-weight: bold; margin-bottom: 10px; display: inline-block;}
        .indicadores-toggle:hover {text-decoration: underline;}
        .indicadores-container {overflow: hidden; transition: max-height 0.3s ease;}
        .indicadores-container.collapsed {max-height: 0;}
        .config-options {padding-top: 15px;}
        .github-section {margin-top: 20px; padding-top: 15px; border-top: 1px solid #eee;}
        .github-input {margin-bottom: 10px;}
        .factores-modal .modal-dialog {max-width: 90%;}
        .factores-table {width: 100%; border-collapse: collapse;}
        .factores-table th, .factores-table td {border: 1px solid #ddd; padding: 8px; text-align: left;}
        .factores-table th {background-color: #f2f2f2; font-weight: bold;}
        .factores-table tr:nth-child(even) {background-color: #f9f9f9;}
        .report-options {padding-top: 15px;}
        .estado-checkbox {margin-right: 10px;}
        .checkbox-label {margin-right: 15px;}
        .factor-sin-propuestas {color: #6c757d; font-style: italic; margin-top: 10px;}
        .gist-list {max-height: 300px; overflow-y: auto; margin-top: 10px;}
        .gist-item {padding: 10px; border: 1px solid #dee2e6; border-radius: 5px; margin-bottom: 5px; cursor: pointer;}
        .gist-item:hover {background-color: #f8f9fa;}
        
        /* Estilos para PWA */
        .install-prompt {position: fixed; bottom: 20px; left: 20px; background-color: var(--primary-color); color: white; padding: 12px 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1001; display: none;}
        .install-prompt button {background: white; color: var(--primary-color); border: none; padding: 8px 16px; border-radius: 4px; margin-left: 10px; cursor: pointer; font-weight: bold;}
        .install-prompt button:hover {background: #f8f9fa;}
        .offline-indicator {position: fixed; top: 0; left: 0; right: 0; background-color: #ffc107; color: #000; text-align: center; padding: 8px; z-index: 1002; display: none;}
        
        @media (max-width: 768px) {
            .welcome-screen h1 {font-size: 2rem;}
            .welcome-screen h2 {font-size: 1.5rem;}
            .welcome-screen p {font-size: 1rem;}
            .area-title {font-size: 1.3rem;}
            .factor-title {font-size: 1rem;}
            .propuesta-card {padding: 15px;}
            .back-to-top {width: 40px; height: 40px; bottom: 15px; right: 15px;}
            .filter-section .row > div {margin-bottom: 15px;}
            .estado-check {margin-right: 8px;}
            .estado-label {margin-right: 5px; font-size: 0.9rem;}
            .factores-modal .modal-dialog {max-width: 95%; margin: 10px auto;}
            .config-toggle, .report-toggle, .filter-toggle {font-size: 0.95rem;}
            .config-section, .report-section, .filter-section {padding: 15px;}
            .github-input {margin-bottom: 8px;}
            .btn {font-size: 0.9rem; padding: 8px 12px;}
            .install-prompt {left: 10px; right: 10px; bottom: 10px;}
        }
        
        @media (max-width: 576px) {
            .container {padding-left: 10px; padding-right: 10px;}
            .welcome-screen h1 {font-size: 1.8rem;}
            .welcome-screen h2 {font-size: 1.3rem;}
            header h1 {font-size: 2rem;}
            .area-title {font-size: 1.2rem;}
            .propuesta-card {padding: 12px;}
            .back-to-top {width: 35px; height: 35px; bottom: 10px; right: 10px;}
            .back-to-top svg {width: 18px; height: 18px;}
            .filter-section .form-label {font-size: 0.9rem;}
            .estado-propuesta {margin-top: 10px; padding-top: 10px;}
            .config-options .btn, .report-options .btn, .filter-content .btn {width: 100%; margin-bottom: 10px;}
            .github-section h6 {font-size: 1rem;}
            .factores-table th, .factores-table td {padding: 6px; font-size: 0.85rem;}
            .modal-header h5 {font-size: 1.1rem;}
            .gist-item h6 {font-size: 0.9rem;}
        }
    </style>
</head>
<body>
    <!-- Indicador de estado offline -->
    <div class="offline-indicator" id="offlineIndicator">
        Estás trabajando sin conexión a Internet
    </div>

    <!-- Prompt de instalación -->
    <div class="install-prompt" id="installPrompt">
        ¿Quieres instalar la aplicación Plan de Mejora?
        <button id="installButton">Instalar</button>
        <button id="dismissInstall">Ahora no</button>
    </div>

    <!-- Pantalla de bienvenida -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="text-center">
            <h1 class="display-3 fw-bold mb-4">PLAN DE MEJORA</h1>
            <h2 class="display-5 mb-3">IES Virgen de Villadiego</h2>
            <p class="fs-4">Curso 2025-2026</p>
            <p class="mt-4">Haz clic en cualquier lugar para continuar</p>
        </div>
    </div>

    <!-- Aplicación principal -->
    <div class="app-container container" id="appContainer">
        <header class="text-center mb-5">
            <h1 class="display-4 fw-bold text-primary">PLAN DE MEJORA</h1>
            <p class="lead">Curso 2025-2026</p>
        </header>

        <!-- Configuración -->
        <div class="config-section">
            <div class="config-toggle" id="configToggle">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear-fill me-2" viewBox="0 0 16 16">
                    <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1-.34c.413-1.4 2.397-1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
                </svg>
                Configuración
            </div>
            <div class="config-content collapsed" id="configContent">
                <div class="config-options">
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="mostrarFactoresSinPropuestas">
                        <label class="form-check-label" for="mostrarFactoresSinPropuestas">
                            Mostrar factores clave sin propuestas
                        </label>
                    </div>
                    
                    <div class="mb-3">
                        <button id="btnExportar" class="btn btn-outline-primary me-2">Exportar datos</button>
                        <button id="btnImportar" class="btn btn-outline-secondary me-2">Importar datos</button>
                        <input type="file" id="importFile" accept=".json" style="display: none;">
                    </div>
                    
                    <div class="github-section">
                        <h6>Guardar en GitHub Gist</h6>
                        <div class="input-group mb-2">
                            <input type="password" id="githubToken" class="form-control github-input" placeholder="Token de GitHub">
                            <button id="btnGuardarToken" class="btn btn-outline-secondary">Guardar token</button>
                        </div>
                        <div class="mb-2">
                            <button id="btnGuardarGist" class="btn btn-outline-success me-2">Guardar en Gist</button>
                            <button id="btnCargarGist" class="btn btn-outline-info">Cargar desde Gist</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generación de informes -->
        <div class="report-section">
            <div class="report-toggle" id="reportToggle">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-pdf-fill me-2" viewBox="0 0 16 16">
                    <path d="M5.523 12.424c.14-.082.293-.162.459-.238a7.878 7.878 0 0 1-.45.606c-.28.337-.498.516-.635.572a.266.266 0 0 1-.035.012.282.282 0 0 1-.026-.044c-.056-.11-.054-.216.04-.36.106-.165.319-.354.647-.548zm2.455-1.647c-.119.025-.237.05-.356.078a21.148 21.148 0 0 0 .5-1.05 12.045 12.045 0 0 0 .51.858c-.217.032-.436.07-.654.114zm2.525.939a3.881 3.881 0 0 1-.435-.41c.228.005.434.022.612.054.317.057.466.147.518.209a.095.095 0 0 1 .026.064.436.436 0 0 1-.06.2.307.307 0 0 1-.094.124.107.107 0 0 1-.069.015c-.09-.003-.258-.066-.498-.256zM8.278 6.97c-.04.244-.108.524-.2.829a4.86 4.86 0 0 1-.089-.346c-.076-.353-.087-.63-.046-.822.038-.177.11-.248.196-.283a.517.517 0 0 1 .145-.04c.013.03.028.092.032.198.005.122-.007.277-.038.465z"/>
                    <path fill-rule="evenodd" d="M4 0h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm5.5 1.5v2a1 1 0 0 0 1 1h2l-3-3zM4.165 13.668c.09.18.23.343.438.419.207.075.412.04.58-.03.318-.13.635-.436.926-.786.333-.401.683-.927 1.021-1.51a11.651 11.651 0 0 1 1.997-.406c.3.383.61.713.91.95.28.22.603.403.934.417a.856.856 0 0 0 .51-.138c.155-.101.27-.247.354-.416.09-.181.145-.37.138-.563a.844.844 0 0 0-.2-.518c-.226-.27-.596-.4-.96-.465a5.76 5.76 0 0 0-1.335-.05 10.954 10.954 0 0 1-.98-1.686c.25-.66.437-1.284.52-1.794.036-.218.055-.426.048-.614a1.238 1.238 0 0 0-.127-.538.7.7 0 0 0-.477-.365c-.202-.043-.41 0-.601.077-.377.15-.576.47-.651.823-.073.34-.04.736.046 1.136.088.406.238.848.43 1.295a19.697 19.697 0 0 1-1.062 2.227 7.662 7.662 0 0 0-1.482.645c-.37.22-.699.48-.897.787-.21.326-.275.714-.08 1.103z"/>
                </svg>
                Generar Informes PDF
            </div>
            <div class="report-content collapsed" id="reportContent">
                <div class="report-options">
                    <div class="mb-4">
                        <h5>Informe por Estado</h5>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input estado-checkbox" type="checkbox" id="estadoNoIniciada" value="no-iniciada" checked>
                            <label class="form-check-label checkbox-label estado-no-iniciada" for="estadoNoIniciada">
                                No iniciadas
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input estado-checkbox" type="checkbox" id="estadoEnProceso" value="en-proceso" checked>
                            <label class="form-check-label checkbox-label estado-en-proceso" for="estadoEnProceso">
                                En proceso
                            </label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input estado-checkbox" type="checkbox" id="estadoConseguida" value="conseguida" checked>
                            <label class="form-check-label checkbox-label estado-conseguida" for="estadoConseguida">
                                Conseguidas
                            </label>
                        </div>
                        <button id="btnGenerarPorEstado" class="btn btn-primary mt-2">Generar PDF por Estado</button>
                    </div>
                    
                    <div class="mb-4">
                        <h5>Informe por Responsable</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="reportResponsable" class="form-label fw-bold">Seleccionar Responsable</label>
                                <select id="reportResponsable" class="form-select">
                                    <option value="">Todos los responsables</option>
                                </select>
                            </div>
                        </div>
                        <button id="btnGenerarPorResponsable" class="btn btn-primary mt-2">Generar PDF por Responsable</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filtros -->
        <div class="filter-section">
            <div class="filter-toggle" id="filterToggle">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-funnel-fill me-2" viewBox="0 0 16 16">
                    <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2z"/>
                </svg>
                Filtros
            </div>
            <div class="filter-content collapsed" id="filterContent">
                <div class="row">
                    <div class="col-12 col-md-3 mb-3">
                        <label for="filtroArea" class="form-label fw-bold">Filtrar por Área</label>
                        <select id="filtroArea" class="form-select">
                            <option value="">Todas las áreas</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-3 mb-3">
                        <label for="filtroFactor" class="form-label fw-bold">Filtrar por Factor Clave</label>
                        <select id="filtroFactor" class="form-select">
                            <option value="">Todos los factores</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-3 mb-3">
                        <label for="filtroResponsable" class="form-label fw-bold">Filtrar por Responsable</label>
                        <select id="filtroResponsable" class="form-select">
                            <option value="">Todos los responsables</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-3 mb-3">
                        <label for="filtroEstado" class="form-label fw-bold">Filtrar por Estado</label>
                        <select id="filtroEstado" class="form-select">
                            <option value="">Cualquier estado</option>
                            <option value="no-iniciada">No iniciada</option>
                            <option value="en-proceso">En proceso</option>
                            <option value="conseguida">Conseguida</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <button id="btnLimpiarFiltros" class="btn btn-outline-secondary">Limpiar filtros</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lista de propuestas -->
        <div id="listaPropuestas"></div>

        <!-- Botón para volver arriba -->
        <button class="back-to-top" id="backToTop">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
            </svg>
        </button>
    </div>

    <!-- Modal para mostrar elementos del nivel "bueno" de logro -->
    <div class="modal fade factores-modal" id="factoresModal" tabindex="-1" aria-labelledby="factoresModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="factoresModalLabel">ELEMENTOS A CONSIDERAR QUE DESCRIBEN EL NIVEL "BUENO" DE LOGRO DEL FACTOR CLAVE</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="factoresModalBody">
                    <!-- Contenido dinámico -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para listar Gists -->
    <div class="modal fade" id="gistsModal" tabindex="-1" aria-labelledby="gistsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="gistsModalLabel">Selecciona un Gist para cargar</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="gistsList" class="gist-list">
                        <!-- Los Gists se cargarán aquí dinámicamente -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Módulo principal de la aplicación
        const PlanDeMejoraApp = (function() {
            // Datos completos de las áreas y propuestas
            const areasData = [
                {
                    id: 1,
                    nombre: "La utilización del tiempo de planificación de la enseñanza y de desarrollo de los aprendizajes en el aula",
                    factoresClave: [
                        {
                            id: "1.1",
                            nombre: "Criterios de asignación de enseñanzas, grupos y horarios.",
                            propuestas: [],
                            elementosBueno: [
                                "1. 1. El centro, en virtud de la autonomía pedagógica y organizativa de que dispone, ha elaborado, aprobado y ejecutado un proyecto educativo y de gestión que favorece formas de organización propias (incluyendo una organización del horario escolar propia), dentro de la normativa vigente, respondiendo a las necesidades de aprendizaje del alumnado.",
                                "2. 2. Los criterios para la asignación de enseñanzas, agrupamientos del alumnado, tutorías y elaboración de horarios, están incluidos en el Proyecto Educativo y se aplican, adecuándose a la normativa vigente (inclusión educativa y no segregación, enseñanzas mínimas, atribución docente, número de horas impartidas en un curso, etc.) . Responden a las necesidades de aprendizaje del alumnado y están, en todo caso, orientados a favorecer su éxito escolar.",
                                "3. 3. Los criterios de elaboración de horarios y agrupamientos del alumnado son conocidos y aceptados por la Comunidad Educativa.",
                                "4. 4. La distribución y asignación de aulas y espacios comunes responde a las necesidades de aprendizaje del alumnado.",
                                "5. 5. Los recursos materiales del centro se organizan, distribuyen, aprovechan y utilizan atendiendo a criterios recogidos en el Plan de Centro y teniendo en cuenta las necesidades de aprendizaje del alumnado.",
                                "6. 6. Los recursos humanos del centro se organizan de acuerdo con la normativa en vigor, el contexto y las necesidades de aprendizaje del alumnado, priorizando, en todo caso, el número de horas que se dedican a la aplicación de las medidas de atención a la diversidad."
                            ]
                        },
                        {
                            id: "1.2",
                            nombre: "Cumplimiento del calendario laboral y escolar, y control de ausencias del personal del Centro.",
                            propuestas: [],
                            elementosBueno: [
                                "1. 1. El calendario escolar es difundido entre la comunidad educativa.",
                                "2. 2. Se cumple el horario del primer día de clase, finalización de trimestre y curso, atendiendo en todo caso a la normativa vigente. El centro ha adoptado medidas para facilitar el cumplimiento del calendario escolar, especialmente al finalizar de cada uno de los trimestres.",
                                "3. 3. El equipo directivo realiza una gestión de las ausencias y permisos del personal docente y no docente adecuada a la normativa vigente.",
                                "4. 4. El centro dispone de un soporte material que recoge la asistencia diaria del personal, garantiza su veracidad y la permanencia de la información.",
                                "5. 5. Existe y se aplica en el centro un procedimiento de sustitución del profesorado que garantiza una atención educativa adecuada al alumnado durante las ausencias."
                            ]
                        },
                        {
                            id: "1.3",
                            nombre: "Utilización efectiva del tiempo de aprendizaje en el aula.",
                            propuestas: [
                                {
                                    id: "1.3.1",
                                    descripcion: "Realizar equipos docentes específicos para el seguimiento de la convivencia, sobre todo en los casos del alumnado con mayor dificultad.",
                                    indicadores: [
                                        { descripcion: "Seguimiento del número de partes y correcciones.", responsable: "Coordinación de Convivencia" },
                                        { descripcion: "Acta del equipo docente.", responsable: "Titulares de las tutorías" },
                                        { descripcion: "Seguimiento de la eficacia de las propuestas realizadas en cada equipo.", responsable: "Departamento de Orientación" },
                                        { descripcion: "Realizar un calendario de reuniones.", responsable: "Jefatura de Estudios" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "1.3.2",
                                    descripcion: "Solicitud del programa Erasmus +",
                                    indicadores: [
                                        { descripcion: "Solicitud del programa.", responsable: "Jefatura del Departamento de Inglés" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "1.3.3",
                                    descripcion: "Realizar actividades en todas las materias para mejorar las técnicas de estudio / aprendizaje del alumnado, principalmente en 1º y 2º.",
                                    indicadores: [
                                        { descripcion: "Número de actividades realizadas.", responsable: "Profesorado" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1.1. Cumplimiento de horarios al comienzo y final de las clases y organización de las entradas y salidas del centro: a) El alumnado cumple de manera habitual el horario de entrada al centro y a las aulas y comienza su actividad lectiva sin retrasos. Las clases finalizan a la hora prevista. La organización de las entradas y salidas al recreo y comienzo y final de la jornada permite que los alumnos/as lo hagan de manera ordenada y con garantías suficientes de seguridad. b) Los intercambios de clase son rápidos y se hacen con la oportuna vigilancia planificada del profesorado, de manera que las clases comienzan sin retrasos injustificados. c) Se han elaborado y difundido unas normas de cara a las entradas y salidas del alumnado, incluyendo las que se producen fuera del horario general del centro. Las familias han sido informadas de ello y, en su caso, el alumnado mayor de edad.",
                                "2. 2. Se dedica habitualmente el tiempo de trabajo del aula al desarrollo efectivo del currículo, caracterizado fundamentalmente por el diseño y aplicación de tareas motivadoras para el alumnado que parten de situaciones-problema reales y se adaptan a los diferentes ritmos y estilos de aprendizaje de cada alumno y alumna, favoreciendo la capacidad de aprender por sí mismos y promoviendo el trabajo en equipo, haciendo uso de métodos, recursos y materiales didácticos diversos.",
                                "3. 3. Las actividades complementarias y extraescolares (*): a) Se orientan a la realización de actividades que contribuyen al desarrollo del currículo. b) Se desarrollan de manera equilibrada durante los tres trimestres del curso. c) Se diseñan teniendo en cuenta los intereses de los alumnos/as y sin discriminación por razones económicas.",
                                "4. 4. Las actividades extraescolares (*) y complementarias se llevan a cabo teniendo en cuenta los necesarios aspectos legales (autorización de los padres/madres, número mínimo de profesorado, aprobación en órganos correspondientes, atención al alumnado que no participa, etc.). (*) Se entiende aquí actividades extraescolares como aquellas que se desarrollan totalmente o en parte fuera del horario lectivo y están organizadas por algún Órgano de Coordinación Docente del centro."
                            ]
                        }
                    ]
                },
                {
                    id: 2,
                    nombre: "La concreción del currículum que hay que desarrollar, adaptado al contexto, y la planificación efectiva de la práctica docente",
                    factoresClave: [
                        {
                            id: "2.1",
                            nombre: "Establecimiento de secuencias de contenidos por áreas o materias en cada curso y ciclo para toda la etapa, o por cualquier otro procedimiento de ordenación del currículum (proyectos, tareas,...), de acuerdo con los objetivos y competencias clave.",
                            propuestas: [
                                {
                                    id: "2.1.1",
                                    descripcion: "Realización, en las diferentes materias, de mayor variedad de actividades evaluables.",
                                    indicadores: [
                                        { descripcion: "Situaciones de aprendizaje en el repositorio del centro.", responsable: "Profesorado" },
                                        { descripcion: "Evaluación del seguimiento de la consecución de la propuesta.", responsable: "Jefatura del Departamento FOREVIN" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. El centro ha realizado la concreción y adaptación definitiva de las enseñanzas curriculares en función de las diversas situaciones escolares y de las características específicas del alumnado al que atiende.",
                                "2. 2. En Educación Primaria, el centro ha considerado la organización de las áreas en ámbitos de conocimiento y experiencia para facilitar un planteamiento integrado y relevante del proceso de enseñanza aprendizaje del alumnado, manteniendo en todo caso la evaluación diferenciada de las distintas áreas curriculares que componen dicho ámbito.",
                                "3. 3. Se ha establecido una secuenciación de contenidos, criterios de evaluación y estándares de aprendizaje evaluables a lo largo de cada etapa educativa por áreas, ámbitos, materias o módulos en cada curso y ciclo, teniendo en cuenta en todo caso la adquisición de las competencias clave. Además, se han definido indicadores de evaluación como concreción y secuenciación de los estándares de aprendizaje evaluables.",
                                "4. 4. Se han elaborado las Programaciones Didácticas o, en su caso, las Propuestas Pedagógicas, correspondientes a las áreas, materias, ámbitos o módulos profesionales asignados al departamento o equipos de ciclo, de acuerdo con los criterios establecidos en el Proyecto Educativo, integrando, en su caso, los contenidos en unidades didácticas que recogen criterios de evaluación, contenidos, objetivos y su contribución a la adquisición de las competencias clave secuenciadas de forma coherente para cada curso, estructurando los elementos del currículo en torno a actividades y tareas de aprendizaje que permitan al alumnado la puesta en práctica del conocimiento dentro de contextos diversos.",
                                "5. 5. Las Programaciones Didácticas integran las competencias clave teniendo en cuenta la actual regulación normativa, el contexto y necesidades educativas y características del alumnado, que se tendrán en cuenta en la elaboración de unidades didácticas integradas que recojan criterios de evaluación, contenidos, objetivos y su contribución a la adquisición de las competencias clave secuenciadas de forma coherente con el nivel de aprendizaje de las alumnas y los alumnos.",
                                "6. 6. Las Programaciones Didácticas incorporan métodos que tienen en cuenta los diferentes ritmos y estilos de aprendizaje del alumnado, que favorecen la capacidad de aprender por sí mismos y que promuevan el trabajo en equipo.",
                                "7. 7. Las Programaciones Didácticas solo se modifican o actualizan como consecuencia de los procesos de autoevaluación desarrollados en el centro."
                            ]
                        },
                        {
                            id: "2.2",
                            nombre: "Desarrollo de estrategias metodológicas propias del área o materia para abordar los procesos de enseñanza y aprendizaje, con especial atención a: Leer, escribir, hablar y escuchar; Aprendizaje de las matemáticas ligado a situaciones de la vida cotidiana; Desarrollo del conocimiento científico, la expresión artística y la actividad física; Clima positivo de convivencia y promoción de valores de relación interpersonal; Utilización de nuevas tecnologías de la información y comunicación.",
                            propuestas: [
                                {
                                    id: "2.2.1",
                                    descripcion: "Promover la resolución en tiempo real y en la pizarra de clase de determinadas tareas propuestas en pruebas de evaluación, con el fin de acreditar el dominio por parte del alumnado.",
                                    indicadores: [
                                        { descripcion: "Registro de evaluación del profesorado.", responsable: "Profesorado" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "2.2.2",
                                    descripcion: "Formación del profesorado para la mejora del razonamiento matemático.",
                                    indicadores: [
                                        { descripcion: "Actividades realizadas.", responsable: "Profesorado" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "2.2.3",
                                    descripcion: "Formación del profesorado en competencia lingüística y plurilingual",
                                    indicadores: [
                                        { descripcion: "Número de actividades realizadas.", responsable: "Profesorado" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "2.2.4",
                                    descripcion: "Seguimiento periódico, a nivel de departamento, de las actividades relacionadas con el fomento de la lectura, dentro del Plan Lector del centro.",
                                    indicadores: [
                                        { descripcion: "Añadir funciones del Departamento en el Plan de Centro.", responsable: "Equipo Directivo" },
                                        { descripcion: "Actas del Departamento.", responsable: "Jefaturas de Departamento" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "2.2.5",
                                    descripcion: "Seguimiento periódico, a nivel de departamento, de las actividades relacionadas con el fomento del razonamiento matemático, en base al Plan establecido por el centro.",
                                    indicadores: [
                                        { descripcion: "Añadir funciones del Departamento en el Plan de Centro.", responsable: "Equipo Directivo" },
                                        { descripcion: "Actas del departamento.", responsable: "Jefaturas de Departamento" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "2.2.6",
                                    descripcion: "Formación del profesorado en metodologías innovadoras que permitan la realización de actividades y tareas significativas para la evaluación por competencias y favorezcan la atención a la diversidad.",
                                    indicadores: [
                                        { descripcion: "Número de profesorado que se inscriben en cursos relacionados con metodologías innovadoras.", responsable: "Jefatura del Departamento FOREVIN" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "2.2.7",
                                    descripcion: "Elaboración y seguimiento de un plan de implantación de metodologías innovadoras",
                                    indicadores: [
                                        { descripcion: "Elaboración del plan de actuación (objetivo, guía metodológica, actuaciones, responsables, plantilla de autoevaluación de la práctica docente y cronograma).", responsable: "Jefatura del Departamento FOREVIN" },
                                        { descripcion: "Situaciones de aprendizaje y autoevaluación de la práctica docente de las actividades realizadas.", responsable: "Profesorado" },
                                        { descripcion: "Evaluación trimestral del uso de metodologías innovadoras que incluya revisión de la autoevaluación de la práctica docente.", responsable: "Jefaturas de Departamento" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. La actividad de aula se adecua a lo establecido en el Proyecto Educativo y en las programaciones o propuestas didácticas y a lo establecido en la normativa vigente.",
                                "2. 2. Se han integrado de manera planificada en la dinámica de trabajo en el aula actividades que propician la adquisición de las competencias clave a través de situaciones educativas que posibilitan, fomentan y desarrollan conexiones con las prácticas sociales y culturales de la comunidad.",
                                "3. 3. Se aplica en el aula una dinámica basada en la utilización diferentes estrategias metodológicas y propuesta de actividades variadas y cercanas a la realidad del alumno/a (de análisis, investigación, preparación de tareas, etc, no sólo de reproducción mecánica), orientadas al aprendizaje que se pretende conseguir, favoreciendo el trabajo individual, cooperativo y el aprendizaje entre iguales.",
                                "4. 4. Se pone en situación al alumnado de integrar los aprendizajes, diseñando en el aula situaciones en las que deben ponerlos en relación con distintos tipos de contenidos y utilizarlos de manera efectiva en diferentes contextos.",
                                "5. 5. Se utilizan en el aula recursos didácticos diversos, especialmente las TICs, para favorecer el desarrollo de actividades y tareas relevantes para el alumnado.",
                                "6. 6. Se propicia la participación e interacción activa del alumnado en el aula.",
                                "7. 7. Se fomenta desde el centro una visión interdisciplinar y multidisciplinar del conocimiento, estableciendo el centro estrategias que propician las conexiones entre diferentes áreas y la aportación de cada una de ellas a la comprensión global de los fenómenos estudiados.",
                                "8. 8. Se han establecido estrategias de coordinación a nivel de equipos de ciclo, equipos docentes, áreas de competencias y departamentos didácticos que permiten homologar básicamente el tratamiento y aplicación de aspectos como criterios de presentación de trabajos del alumnado, pautas de corrección, metodología, etc.",
                                "9. 9. Se desarrollan en las aulas, de manera planificada y acorde con lo programado y la normativa vigente en relación a la adquisición de las competencias clave, actividades relacionadas con: a) Buscar, consultar diferentes fuentes bibliográficas y textos de diferente naturaleza (documentos escritos, imágenes, gráficos) y soporte, aplicando especialmente estrategias de búsqueda y acceso en Internet. b) Desarrollar estrategias adecuadas para seleccionar y organizar información concreta y relevante, analizarla, obtener conclusiones, hacer predicciones y comunicar su experiencia, comunicándola oralmente y por escrito, utilizando especialmente las TICs. c) Utilizar de manera adecuada el vocabulario correspondiente a cada uno de los bloques de contenidos. d) Realizar experiencias sencillas y pequeñas investigaciones, conociendo y aplicando algunas características del método de trabajo científico en contextos de situaciones problemáticas a resolver adaptadas al nivel del alumnado. e) Valorar y describir la influencia del desarrollo tecnológico en las condiciones de vida y en el trabajo, explicando algunos de los avances de la ciencia en el hogar y la vida cotidiana, la medicina, la cultura y el ocio, el arte, la música, el cine y el deporte y las tecnologías de la información y la comunicación. f) Leer de forma fluida y adecuada a la edad del alumnado y comprender textos orales y escritos, según su tipología. g) Participar en situaciones o contextos educativos en los que debe expresarse o comunicarse e intercambiar información de forma oral y comprender mensajes orales de diferente tipo. h) Producir en el aula textos con diferentes intenciones comunicativas. i) Leer, escribir, escuchar, hablar y conversar utilizando una lengua extranjera. j) Plantear y resolver problemas asociados a situaciones de la vida cotidiana, utilizando diferentes estrategias y procedimientos de resolución, siendo capaz de comunicar el procedimiento seguido en la resolución y las conclusiones. k) Utilizar los conocimientos matemáticos (numéricos, medida, magnitudes, geometría, representación espacial) para interpretar, comprender, producir y comunicar informaciones y mensajes y resolver situaciones problemáticas presentes en diferentes contextos de la vida cotidiana."
                            ]
                        }
                    ]
                },
                {
                    id: 3,
                    nombre: "La evaluación de los resultados escolares y la adopción de medidas de mejora adaptadas a las necesidades de aprendizaje del alumnado",
                    factoresClave: [
                        {
                            id: "3.1",
                            nombre: "Criterios de evaluación, promoción y titulación.",
                            propuestas: [
                                {
                                    id: "3.1.1",
                                    descripcion: "Modificación y seguimiento del Plan de Recuperación de materias pendientes.",
                                    indicadores: [
                                        { descripcion: "Modificación de los apartados D y G del Proyecto Educativo.", responsable: "Claustro" },
                                        { descripcion: "Plan de recuperación de pendientes recogido en la programación didáctica de cada Departamento.", responsable: "Jefaturas de Departamento" },
                                        { descripcion: "Seguimiento de plan de recuperación de pendientes recogido en la última acta de cada mes del departamento.", responsable: "Jefaturas de Departamento" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. El Proyecto Educativo del centro incluye la concreción de los procedimientos y criterios de evaluación y promoción del alumnado, y, en su caso, los de titulación y se adecuan a la normativa vigente.",
                                "2. 2. La aplicación de los procedimientos y criterios de evaluación se realiza de forma homologada y coordinada por los docentes en el seno de los Departamentos Didácticos, Equipos de Ciclo o Equipos Docentes, y en todo caso se garantiza la objetividad, el valor continuo, criterial y formativo de la evaluación.",
                                "3. 3. Los criterios de evaluación se han diseñado como referentes del grado de adquisición de las competencias clave y del logro de los objetivos generales de las áreas/materias y de la etapa. Los estándares de aprendizaje se reflejan en los documentos de planificación como concreción de los criterios de evaluación, permitiendo definir los resultados esperados.",
                                "4. 4. Se ha planificado y llevado a cabo la difusión de los procedimientos y criterios de evaluación entre alumnado y familias.",
                                "5. 5. Se ha planificado la realización de la evaluación inicial.",
                                "6. 6. Los instrumentos aprobados en el nivel/ciclo/departamento para llevar a cabo la evaluación inicial incorporan actividades que permiten identificar y registrar el logro del alumnado en relación con las competencias clave."
                            ]
                        },
                        {
                            id: "3.2",
                            nombre: "Evaluación del alumnado que realiza el centro y resultados de pruebas externas.",
                            propuestas: [],
                            elementosBueno: [
                                "1. 1. En las sesiones de evaluación se produce un intercambio de información relevante sobre los procesos de aprendizaje del alumnado y se adoptan decisiones orientadas a la mejora de dicho proceso. Los acuerdos adoptados tienen un seguimiento y se evalúa de manera sistemática su implantación.",
                                "2. 2. Se planifican y desarrollan de manera sistemática procesos de revisión y evaluación del proceso de enseñanza, incluidos dentro de los procedimientos de evaluación interna del centro, que tienen como consecuencia la elaboración de propuestas de mejora que afectan a la práctica docente en el aula.",
                                "3. 3. Los resultados obtenidos en las pruebas externas se utilizan para orientar los procesos de evaluación interna y el diseño de planes de mejora que se desarrollan en el centro.",
                                "4. 4. La evaluación inicial tiene efectos reales sobre las Programaciones Didácticas previstas y adaptaciones al grupo de alumnado y a sus necesidades educativas.",
                                "5. 5. Los aprendizajes del alumnado se evalúan con sistematicidad o regularidad en la anotación de valoraciones o registros de evaluación, entendiendo que el proceso de evaluación continua no puede ceñirse a unos pocos/escasos momentos puntuales a lo largo del curso.",
                                "6. 6. Las realizaciones del alumnado (trabajos, cuadernos, pruebas, etc.) se corrigen de forma que contribuyen a la mejora de los aprendizajes, formando parte y estando plenamente integrada dicha corrección en el proceso de aprendizaje individual y continuo de cada alumno/a.",
                                "7. 7. En el contexto del proceso de evaluación continua, se establecen mecanismos para detectar que el progreso de un alumno o alumna no es el adecuado, arbitrándose medidas de refuerzo educativo. Estas medidas se adoptan en cualquier momento del curso escolar, tan pronto como se detecten las dificultades y están dirigidas a garantizar la adquisición de las competencias clave."
                            ]
                        }
                    ]
                },
                {
                    id: 4,
                    nombre: "La inclusión escolar y la atención a las necesidades de aprendizaje como respuesta educativa a todo el alumnado y la consecución del éxito escolar para todos",
                    factoresClave: [
                        {
                            id: "4.1",
                            nombre: "Medidas de atención a la diversidad adaptadas a las necesidades específicas del alumnado.",
                            propuestas: [
                                {
                                    id: "4.1.1",
                                    descripcion: "Organizar talleres y/o torneos de ajedrez.",
                                    indicadores: [
                                        { descripcion: "Realización de los torneos.", responsable: "Departamento de Dibujo" },
                                        { descripcion: "Número de torneos realizados.", responsable: "Departamento de Dibujo" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "4.1.2",
                                    descripcion: "Formación del profesorado en la atención al alumnado NEAE, para aplicar tanto en el Aula Específica como en las aulas ordinarias.",
                                    indicadores: [
                                        { descripcion: "Actividades formativas realizadas.", responsable: "Profesorado" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "4.1.3",
                                    descripcion: "Realización y seguimiento de un grupo de trabajo relacionado con la atención al alumnado NEAE y, especialmente, de alumnado TEA en el aula ordinaria.",
                                    indicadores: [
                                        { descripcion: "Solicitud del grupo de trabajo.", responsable: "Jefatura del Departamento FOREVIN" },
                                        { descripcion: "Actividades realizadas en el grupo de trabajo.", responsable: "Coordinación del Grupo de Trabajo" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. Se han incluido en el Proyecto Educativo medidas de atención a la diversidad según el contexto y necesidades del alumnado acordes con la normativa vigente.",
                                "2. 2. En el Proyecto Educativo se han concretado y se llevan a cabo estrategias de coordinación en la aplicación de las medidas de atención a la diversidad.",
                                "3. 3. Se han planificado y aplicado mecanismos de que permiten realizar una detección temprana de dificultades, derivando el caso a responsables según el caso, proponiendo y aplicando medidas organizativas y curriculares ajustadas a norma, y comunicándolo de manera inmediata a la familia.",
                                "4. 4. Se ha planificado y se lleva a cabo el proceso de seguimiento individualizado y evaluación de la eficacia de las medidas de atención a la diversidad adoptadas.",
                                "5. 5. Se desarrollan, por parte de los responsables, las acciones previstas en la normativa en los casos de absentismo del alumnado (prevención, seguimiento y control). El centro mantiene los mecanismos de coordinación externos en relación con el absentismo escolar y desarrolla acciones preventivas del abandono escolar en coordinación con otros agentes e instituciones del entorno.",
                                "6. 6. El centro ha previsto diferentes medidas de inclusión escolar para el alumnado absentista a su regreso al centro y para el alumnado en riesgo de abandono escolar.",
                                "7. 7. Se han incluido en el Proyecto Educativo y se aplican criterios para la asignación de responsables de las medidas de atención a la diversidad y para la priorización de recursos humanos y materiales y horarios del alumnado en función de sus necesidades educativas.",
                                "8. 8. Se han incluido en el Proyecto Educativo y se aplican estrategias y procedimientos de comunicación, información y conocimiento de la opinión de las familias sobre las medidas de atención a la diversidad adoptadas con sus hijos/as y su progreso en el aprendizaje."
                            ]
                        },
                        {
                            id: "4.2",
                            nombre: "Programación adaptada.",
                            propuestas: [
                                {
                                    id: "4.2.1",
                                    descripcion: "Promover el aumento del número y el tipo de actividades que impliquen la puesta en práctica de la competencia digital por parte del alumnado.",
                                    indicadores: [
                                        { descripcion: "Situaciones de aprendizaje.", responsable: "Profesorado" },
                                        { descripcion: "Seguimiento periódico por parte del FOREVIN.", responsable: "Departamento FOREVIN" },
                                        { descripcion: "Mejora de la competencia digital del alumnado.", responsable: "Responsable TDE" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "4.2.2",
                                    descripcion: "Realización de una situación de aprendizaje entre al menos dos departamentos.",
                                    indicadores: [
                                        { descripcion: "Repositorio de situaciones de aprendizaje del centro.", responsable: "Jefaturas de área" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "4.2.3",
                                    descripcion: "Plantear actividades evaluables en las que al alumnado se le dé un problema resuelto y deba detectar errores y explicar cómo se resolvería correctamente.",
                                    indicadores: [
                                        { descripcion: "Elaboración de los problemas.", responsable: "Jefaturas de departamentos científico-tecnológicos" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. Se ha incluido en el Proyecto Educativo y se aplica un protocolo de detección de necesidades específicas de apoyo educativo y las diferentes medidas a poner en marcha, con identificación de responsables de diagnóstico, elaboración, aplicación, coordinación y evaluación.",
                                "2. 2. La organización y aplicación de los programas de refuerzo, las adaptaciones curriculares, las medidas de apoyo especifico y otras que se acuerden, son acordes con la norma, el contexto y necesidades educativas del alumnado.",
                                "3. 3. La asignación y práctica docente del profesorado responsable a los programas de apoyo en sus distintas modalidades de escolarización, su desarrollo y evaluación, se adecua a la norma y, en todo caso, se realiza de forma coordinada entre el personal de apoyo específico y los docentes que imparten áreas, materias, ámbitos o módulos.",
                                "4. 4. Se lleva a cabo una aplicación de los Programas de Refuerzo ajustada a lo establecido en la norma y en el propio Proyecto Educativo, al contexto y necesidades educativas del alumnado.",
                                "5. 5. La asignación y práctica docente del profesorado responsable a los programas de refuerzo, su desarrollo y evaluación, se adecua a la norma.",
                                "6. 6. Se realiza un seguimiento y evaluación de manera individualizada del alumnado con dificultades de aprendizaje, que sigue algún programa (refuerzo, recuperación de aprendizajes, plan específico) o necesidades específicas de apoyo educativo, y de ello se facilita, de manera planificada, información a las familias."
                            ]
                        },
                        {
                            id: "4.3",
                            nombre: "Tutorización del alumnado, relación con las familias y el entorno.",
                            propuestas: [
                                {
                                    id: "4.3.1",
                                    descripcion: "Realizar una reunión de la persona titular de la tutoría al comienzo de las evaluaciones segunda y tercera. Se tratarán: 1) análisis de los resultados; 2) análisis de la convivencia; 3) dudas; 4) propuestas de mejora.",
                                    indicadores: [
                                        { descripcion: "Actas de las reuniones.", responsable: "Titulares de las tutorías" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "4.3.2",
                                    descripcion: "Uso del Cuaderno Séneca por parte del profesorado",
                                    indicadores: [
                                        { descripcion: "Desarrollo de actividades evaluables a través del cuaderno.", responsable: "Profesorado" },
                                        { descripcion: "Feedback por parte de las familias en las Comisiones de Aula o en las reuniones que se tengan con los tutores y tutoras.", responsable: "Titulares de las tutorías" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "4.3.3",
                                    descripcion: "Incluir en el Cuaderno de Séneca una o varias actividades de evaluación diarias, para medir diferentes aspectos que no aparecen en los criterios de evaluación (por ejemplo, comportamiento, estudio, hacer tareas...), pero que pueden ayudar en el control parental del alumnado, e incluir los ítems de los compromisos de convivencia.",
                                    indicadores: [
                                        { descripcion: "Feedback de las familias en la Comisión de Aula o reuniones con los respectivos tutores/as.", responsable: "Titulares de las tutorías" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "4.3.4",
                                    descripcion: "Tratar en la Escuela de Familias las necesidades educativas y emocionales de los adolescentes. Gestión del tiempo, de emociones, y comunicación efectiva y afectiva con los adolescentes. Uso responsable de las tecnologías.",
                                    indicadores: [
                                        { descripcion: "Realización de las diferentes sesiones formativas.", responsable: "Departamento de Orientación" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. Se ha incluido en el Proyecto Educativo el Plan de Orientación y Acción Tutorial ajustado a la norma, al contexto y necesidades educativas del alumnado.",
                                "2. 2. Se desarrolla el Plan de Orientación y Acción Tutorial conforme lo establecido en la norma y en el Proyecto Educativo del Centro.",
                                "3. 3. Se han diseñado y aplicado estrategias de difusión del contenido del Plan de Orientación y Acción Tutorial entre la comunidad educativa. Además, se ha informado a las familias convenientemente de los horarios de atención en tutorías.",
                                "4. 4. Se han incluido en el Plan de Orientación y Acción Tutorial medidas de acogida al alumnado, estrategias de detección de dificultades y las posibles medidas a adoptar como consecuencia de ello.",
                                "5. 5. En el Proyecto Educativo se ha incluido la planificación de los Programas de Tránsito entre etapas y los mecanismos de coordinación entre los centros y servicios educativos para desarrollarlos.",
                                "6. 6. En el Proyecto Educativo se han incluido las estrategias y procedimientos de información a las familias del proceso de aprendizaje del alumnado, y para suscribir compromisos educativos y de convivencia.",
                                "7. 7. Los horarios dedicados a tutorías de alumnado y familias se ajustan a la norma vigente, y la ubicación temporal de la atención a padres y madres es adecuada a la norma y compatible con su vida laboral."
                            ]
                        }
                    ]
                },
                {
                    id: 5,
                    nombre: "Una dirección y coordinación del centro orientada a la eficacia de la organización en la consecución y mejora de los logros escolares de todo el alumnado",
                    factoresClave: [
                        {
                            id: "5.1",
                            nombre: "El Equipo Directivo, Órganos Colegiados de Gobierno y Órganos de Coordinación Docente.",
                            propuestas: [
                                {
                                    id: "5.1.1",
                                    descripcion: "Elaboración y puesta en marcha de un Plan de Acogida al profesorado de nueva incorporación.",
                                    indicadores: [
                                        { descripcion: "Realización del Plan de Acogida del profesorado (objetivos, acciones, responsables, cronograma y evaluación).", responsable: "Jefatura de Estudios" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. Se desarrolla y aplica el Proyecto de Dirección en el centro, que incorpora propuestas y medidas de mejora de los procesos de enseñanza, así como estrategias para su evaluación y seguimiento.",
                                "2. 2. El Plan de Centro se actualiza o modifica a propuesta del director o directora en función de su proyecto de dirección o como consecuencia de los procesos de autoevaluación desarrollados en el centro.",
                                "3. 3. El Equipo Directivo, y cada uno de sus componentes, cumple con las funciones y competencias marcadas en la norma al respecto.",
                                "4. 4. La composición, elección en su caso, ejercicio de competencias, y régimen de funcionamiento de los órganos colegiados cumple con la normativa vigente.",
                                "5. 5. La composición, nombramiento de responsables de los órganos de coordinación docente y el ejercicio de sus competencias cumple con lo establecido en el Proyecto Educativo y en la norma.",
                                "6. 6. Los órganos de coordinación docente se reúnen con la periodicidad que establece el Proyecto Educativo y la norma, siendo el contenido de sus reuniones acorde con las competencias que tienen atribuidas, adecuándose al contexto y necesidades del centro. Se adoptan a nivel de Equipo de Ciclo/Departamento o Equipos Docentes acuerdos referidos a la práctica docente y se realiza un seguimiento y evaluación de dicha aplicación.",
                                "7. 7. El Proyecto Educativo incluye los procedimientos de evaluación interna que se impulsan desde la dirección del centro y se llevan a cabo de manera habitual y continua, implicando a todos los sectores de la Comunidad Educativa, permitiendo identificar prácticas de referencia y aspectos susceptibles de mejora.",
                                "8. 8. Consecuencia de los procesos de evaluación interna, se diseña un Plan Anual de Mejora que incluye las propuestas de mejora que se van a desarrollar durante un curso académico y que ha de contemplar prioritariamente las acciones específicas que mejoren la atención al alumnado que presenta dificultades de aprendizaje. La valoración del Plan Anual de Mejora plasmada en la Memoria de Autoevaluación implica modificaciones en el Plan de Centro.",
                                "9. 9. El centro ha planificado y aplica mecanismos de valoración del grado de utilización y eficacia de las intervenciones de los distintos servicios externos en el centro, teniendo en cuenta la integración de sus actuaciones en el funcionamiento del centro, su adecuación a su contexto y necesidades y el nivel de coordinación con dichos servicios externos."
                            ]
                        },
                        {
                            id: "5.2",
                            nombre: "Los documentos de planificación.",
                            propuestas: [],
                            elementosBueno: [
                                "1. 1. El centro ha diseñado y puesto en marcha mecanismos efectivos de participación de los distintos sectores de la Comunidad Educativa, en virtud de las competencias otorgadas a cada one por la norma, para la elaboración y revisión del Plan de Centro: el Proyecto Educativo, el Reglamento de Organización y Funcionamiento, y el Proyecto de Gestión.",
                                "2. 2. El contenido del Proyecto Educativo, Reglamento de Organización y Funcionamiento, y el Proyecto de Gestión es acorde con la regulación normativa y coherente con el contexto, resultados académicos y necesidades de aprendizaje del alumnado.",
                                "3. 3. Los documentos que componen el Plan de Centro se han contextualizado a la realidad del centro y ajustado a las necesidades educativas del alumnado. En este sentido, los proyectos editoriales, libros de texto y recursos educativos utilizados por el centro en su conjunto son útiles en tanto que se ponen al servicio de las necesidades del alumnado y contexto del centro y son coherentes con el Proyecto Educativo y las propias Programaciones Didácticas.",
                                "4. 4. Se han planificado y se aplican estrategias de coordinación para el desarrollo de las propuestas de mejora incluidas en el Plan Anual de Mejora, en especial en lo relacionado con los procesos de enseñanza y aprendizaje, y logros escolares del alumnado. Dichas propuestas son concretas, están relacionadas con los objetivos del centro expresados en el Plan de Centro, y contienen una planificación de responsables, tiempos, control y seguimiento e indicadores de calidad.",
                                "5. 5. Las Programaciones Didácticas se modifican solo como consecuencia de los procesos de autoevaluación desarrollados en el centro.",
                                "6. 6. Se han diseñado e incluido en el Proyecto Educativo, y se llevan a la práctica, mecanismos de coordinación entre el profesorado a nivel de órganos de coordinación docente, sobre todo en el desarrollo y aplicación de la Programación Didáctica o Propuesta Pedagógica, y a nivel de centro.",
                                "7. 7. Se han incluido en el Proyecto Educativo mecanismos de evaluación de la incidencia que a nivel de aula tienen los planes, programas y proyectos que se desarrollan en el centro, teniendo en cuenta el nivel de incorporación que hace el docente en su práctica diaria de las orientaciones, directrices, actividades etc. que en ellos se reflejan y los logros del alumnado."
                            ]
                        }
                    ]
                },
                {
                    id: 6,
                    nombre: "La relación interpersonal y los valores de la convivencia dentro de un apropiado clima escolar",
                    factoresClave: [
                        {
                            id: "6.1",
                            nombre: "Regulación y educación para la convivencia.",
                            propuestas: [
                                {
                                    id: "6.1.1",
                                    descripcion: "Implementar la campaña '10 meses, 10 causas', ajustándola a las necesidades del ejercicio escolar.",
                                    indicadores: [
                                        { descripcion: "Reuniones de la Coordinación de Convivencia / Orientación con los responsables de tutorías.", responsable: "Coordinación de Convivencia" },
                                        { descripcion: "Difundir la campaña en el claustro inicial sobre convivencia.", responsable: "Coordinación de Convivencia" },
                                        { descripcion: "Difundir la campaña en las redes sociales del centro y por iPasen.", responsable: "Community Manager" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. El centro ha elaborado el Plan de Convivencia que incluye los apartados que se establecen en la normativa y se adecua a su contexto.",
                                "2. 2. Se han planificado y se han aplicado estrategias para la difusión y conocimiento por parte de la Comunidad Educativa del Plan de Convivencia.",
                                "3. 3. Se han establecido y se desarrollan mecanismos para evaluar la aplicación de las medidas incluidas en el Plan de Convivencia y sus resultados. Se analizan los datos de convivencia, las medidas que se adoptan y los resultados obtenidos en el seno de los órganos con competencias para ello.",
                                "4. 4. El Plan de Convivencia incluye medidas y actuaciones preventivas y para la detección de la conflictividad de la convivencia en el centro.",
                                "5. 5. Se han establecido normas de convivencia generales y de aula con participación de la comunidad educativa, especialmente del alumnado en el proceso de elaboración.",
                                "6. 6. El profesorado adopta criterios comunes, previamente consensuados, para abordar las incidencias relacionadas con la convivencia, fundamentalmente en cuanto a las faltas a sancionar y la manera de hacerlo, atendiendo en todo caso la normativa vigente. El centro pone en marcha actuaciones de tipo preventivo para evitar que hechos sancionados se produzcan de nuevo.",
                                "7. 7. Las incidencias y correcciones impuestas se registran de manera sistemática en el Sistema de Información Séneca.",
                                "8. 8. El centro activa los protocolos de acoso escolar, maltrato infantil, violencia de género en el ámbito educativo y agresión hacia el profesorado o el personal no docente, establecidos en la norma cuando los hechos acaecidos así lo requieren.",
                                "9. 9. El centro ha articulado los mecanismos de participación de las familias en el proceso educativo de sus hijos/as. Se ofrece a las familias la posibilidad de firmar Compromisos educativos y de convivencia. Se realiza un seguimiento de los compromisos firmados, su contenido y resultados obtenidos."
                            ]
                        },
                        {
                            id: "6.2",
                            nombre: "La inclusión de la educación en valores en la actividad educativa del centro.",
                            propuestas: [
                                {
                                    id: "6.2.1",
                                    descripcion: "Necesidad de formación por parte del alumnado de 4º de ESO en mediación de conflictos.",
                                    indicadores: [
                                        { descripcion: "Número de alumnos/as que se forman.", responsable: "Departamento de Orientación" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "1. 1. El Proyecto Educativo del centro incluye elementos de la cultura andaluza y educación en valores que se han integrado en el currículo, adecuados al contexto del alumnado y a la normativa vigente.",
                                "2. 2. Se llevan a cabo en las aulas actividades y programas específicos relacionados con la cultura andaluza y la educación en valores, coherentes con lo planificado en el Proyecto Educativo y lo establecido en la normativa vigente.",
                                "3. 3. Se ha considerado la perspectiva de género para la elaboración y desarrollo del Proyecto Educativo.",
                                "4. 4. El centro ha nombrado coordinador o coordinadora responsable en materia de coeducación, con el horario de dedicación y ejercicio de sus funciones establecidas en la norma. Además, se ha nombrado una persona experta en materia de género en el Consejo Escolar. Se desarrollan actividades específicas relacionadas con la perspectiva de género y la coeducación."
                            ]
                        }
                    ]
                },
                {
                    id: 7,
                    nombre: "Otras propuestas de mejora en relación con los objetivos",
                    factoresClave: [
                        {
                            id: "7.0",
                            nombre: "Propuestas generales",
                            propuestas: [
                                {
                                    id: "7.1",
                                    descripcion: "Instalar un timbre musical.",
                                    indicadores: [
                                        { descripcion: "Presupuesto para el montaje del servicio.", responsable: "Equipo Directivo" },
                                        { descripcion: "Creación de una partida en el presupuesto del centro para el mismo.", responsable: "Equipo Directivo" },
                                        { descripcion: "Valorar la inclusión del timbre en una partida para Inversiones procedente de Delegación Territorial.", responsable: "Equipo Directivo" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "7.2",
                                    descripcion: "Mejorar las instalaciones deportivas.",
                                    indicadores: [
                                        { descripcion: "Estudio del pavimento y de su viabilidad económica.", responsable: "Departamento de Educación Física" },
                                        { descripcion: "Propuesta de diferentes presupuestos.", responsable: "Departamento de Educación Física" },
                                        { descripcion: "Realización de la obra.", responsable: "Equipo Directivo" }
                                    ],
                                    estado: "no-iniciada"
                                },
                                {
                                    id: "7.3",
                                    descripcion: "Implementar las mejoras indicadas en el informe de la empresa Antea sobre riesgos laborales.",
                                    indicadores: [
                                        { descripcion: "Seguimiento del informe.", responsable: "Coordinador de autoprotección" }
                                    ],
                                    estado: "no-iniciada"
                                }
                            ],
                            elementosBueno: [
                                "Se implementan otras propuestas de mejora que contribuyen al logro de los objetivos del centro."
                            ]
                        }
                    ]
                }
            ];

            // Variables globales
            let filtroArea = '';
            let filtroFactor = '';
            let filtroResponsable = '';
            let filtroEstado = '';
            let mostrarFactoresSinPropuestas = false;
            let deferredPrompt;

            // Inicializar la aplicación
            function init() {
                // Configurar evento para la pantalla de bienvenida
                document.getElementById('welcomeScreen').addEventListener('click', function() {
                    this.classList.add('hidden');
                    document.getElementById('appContainer').classList.add('visible');
                    inicializarAplicacion();
                });

                // Configurar botón para volver arriba
                document.getElementById('backToTop').addEventListener('click', function() {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });

                // Mostrar/ocultar botón para volver arriba al hacer scroll
                window.addEventListener('scroll', function() {
                    const backToTopButton = document.getElementById('backToTop');
                    if (window.scrollY > 300) {
                        backToTopButton.classList.add('visible');
                    } else {
                        backToTopButton.classList.remove('visible');
                    }
                });

                // Configurar eventos PWA
                configurarPWA();
            }

            function configurarPWA() {
                // Detectar eventos de instalación
                window.addEventListener('beforeinstallprompt', (e) => {
                    // Prevenir que el mini-infobar aparezca en móviles
                    e.preventDefault();
                    // Guardar el evento para poder activarlo más tarde
                    deferredPrompt = e;
                    // Mostrar el prompt de instalación personalizado
                    mostrarInstallPrompt();
                });

                // Detectar cuando la app se instala
                window.addEventListener('appinstalled', () => {
                    // Ocultar el prompt de instalación
                    ocultarInstallPrompt();
                    // Limpiar deferredPrompt
                    deferredPrompt = null;
                    console.log('PWA instalada');
                });

                // Detectar cambios en la conectividad
                window.addEventListener('online', () => {
                    document.getElementById('offlineIndicator').style.display = 'none';
                });

                window.addEventListener('offline', () => {
                    document.getElementById('offlineIndicator').style.display = 'block';
                });

                // Configurar botones de instalación
                document.getElementById('installButton').addEventListener('click', async () => {
                    if (deferredPrompt) {
                        deferredPrompt.prompt();
                        const { outcome } = await deferredPrompt.userChoice;
                        if (outcome === 'accepted') {
                            console.log('Usuario aceptó instalar la PWA');
                        } else {
                            console.log('Usuario rechazó instalar la PWA');
                        }
                        deferredPrompt = null;
                    }
                });

                document.getElementById('dismissInstall').addEventListener('click', () => {
                    ocultarInstallPrompt();
                    // Guardar en localStorage que el usuario no quiere ver el prompt
                    localStorage.setItem('pwaInstallDismissed', 'true');
                });
            }

            function mostrarInstallPrompt() {
                // Verificar si el usuario ya ha descartado el prompt
                if (!localStorage.getItem('pwaInstallDismissed')) {
                    const installPrompt = document.getElementById('installPrompt');
                    installPrompt.style.display = 'block';
                    
                    // Ocultar automáticamente después de 10 segundos
                    setTimeout(() => {
                        ocultarInstallPrompt();
                    }, 10000);
                }
            }

            function ocultarInstallPrompt() {
                const installPrompt = document.getElementById('installPrompt');
                installPrompt.style.display = 'none';
            }

            function inicializarAplicacion() {
                // Cargar estados guardados
                cargarEstados();
                
                // Cargar token de GitHub si existe
                const tokenGuardado = localStorage.getItem('githubToken');
                if (tokenGuardado) {
                    document.getElementById('githubToken').value = tokenGuardado;
                }
                
                // Llenar selectores de filtros
                llenarFiltroAreas();
                llenarFiltroFactores();
                llenarFiltroResponsables();

                // Configurar eventos de filtros
                document.getElementById('filtroArea').addEventListener('change', function() {
                    filtroArea = this.value;
                    llenarFiltroFactores();
                    actualizarVista();
                });

                document.getElementById('filtroFactor').addEventListener('change', function() {
                    filtroFactor = this.value;
                    actualizarVista();
                });

                document.getElementById('filtroResponsable').addEventListener('change', function() {
                    filtroResponsable = this.value;
                    actualizarVista();
                });

                document.getElementById('filtroEstado').addEventListener('change', function() {
                    filtroEstado = this.value;
                    actualizarVista();
                });

                document.getElementById('btnLimpiarFiltros').addEventListener('click', function() {
                    document.getElementById('filtroArea').value = '';
                    document.getElementById('filtroFactor').value = '';
                    document.getElementById('filtroResponsable').value = '';
                    document.getElementById('filtroEstado').value = '';
                    filtroArea = '';
                    filtroFactor = '';
                    filtroResponsable = '';
                    filtroEstado = '';
                    llenarFiltroFactores();
                    actualizarVista();
                });

                // Configuración del menú desplegable
                document.getElementById('configToggle').addEventListener('click', function() {
                    const configContent = document.getElementById('configContent');
                    configContent.classList.toggle('collapsed');
                });

                // Configuración del menú de informes
                document.getElementById('reportToggle').addEventListener('click', function() {
                    const reportContent = document.getElementById('reportContent');
                    reportContent.classList.toggle('collapsed');
                });

                // Configuración del menú de filtros
                document.getElementById('filterToggle').addEventListener('click', function() {
                    const filterContent = document.getElementById('filterContent');
                    filterContent.classList.toggle('collapsed');
                });

                // Configuración del checkbox para mostrar factores sin propuestas
                document.getElementById('mostrarFactoresSinPropuestas').addEventListener('change', function() {
                    mostrarFactoresSinPropuestas = this.checked;
                    actualizarVista();
                });

                // Configuración de exportación/importación
                document.getElementById('btnExportar').addEventListener('click', exportarDatos);
                document.getElementById('btnImportar').addEventListener('click', function() {
                    document.getElementById('importFile').click();
                });
                document.getElementById('importFile').addEventListener('change', importarDatos);

                // Configuración de GitHub Gists
                document.getElementById('btnGuardarToken').addEventListener('click', guardarToken);
                document.getElementById('btnGuardarGist').addEventListener('click', guardarEnGist);
                document.getElementById('btnCargarGist').addEventListener('click', cargarDesdeGist);

                // Configuración de generación de informes
                document.getElementById('btnGenerarPorEstado').addEventListener('click', generarPDFPorEstado);
                document.getElementById('btnGenerarPorResponsable').addEventListener('click', generarPDFPorResponsable);

                // Mostrar todas las propuestas inicialmente
                actualizarVista();
            }

            function guardarToken() {
                const token = document.getElementById('githubToken').value;
                if (token) {
                    localStorage.setItem('githubToken', token);
                    alert('Token guardado correctamente');
                } else {
                    alert('Por favor, introduce un token de GitHub');
                }
            }

            function llenarFiltroAreas() {
                const selectArea = document.getElementById('filtroArea');
                selectArea.innerHTML = '<option value="">Todas las áreas</option>';
                
                areasData.forEach(area => {
                    const option = document.createElement('option');
                    option.value = area.id;
                    option.textContent = `${area.id}. ${area.nombre}`;
                    selectArea.appendChild(option);
                });
            }

            function llenarFiltroFactores() {
                const selectFactor = document.getElementById('filtroFactor');
                selectFactor.innerHTML = '<option value="">Todos los factores</option>';
                
                let factores = [];
                
                if (filtroArea) {
                    const area = areasData.find(a => a.id == filtroArea);
                    if (area) {
                        factores = area.factoresClave;
                    }
                } else {
                    areasData.forEach(area => {
                        factores = factores.concat(area.factoresClave);
                    });
                }
                
                factores.forEach(factor => {
                    const option = document.createElement('option');
                    option.value = factor.id;
                    option.textContent = `${factor.id}. ${factor.nombre.substring(0, 100)}${factor.nombre.length > 100 ? '...' : ''}`;
                    selectFactor.appendChild(option);
                });
            }

            function llenarFiltroResponsables() {
                const selectResponsable = document.getElementById('filtroResponsable');
                const reportResponsable = document.getElementById('reportResponsable');
                
                selectResponsable.innerHTML = '<option value="">Todos los responsables</option>';
                reportResponsable.innerHTML = '<option value="">Todos los responsables</option>';
                
                const responsables = new Set();
                
                areasData.forEach(area => {
                    area.factoresClave.forEach(factor => {
                        factor.propuestas.forEach(propuesta => {
                            propuesta.indicadores.forEach(indicador => {
                                if (indicador.responsable && indicador.responsable.trim() !== '') {
                                    responsables.add(indicador.responsable);
                                }
                            });
                        });
                    });
                });
                
                const responsablesOrdenados = Array.from(responsables).sort();
                responsablesOrdenados.forEach(responsable => {
                    const option1 = document.createElement('option');
                    option1.value = responsable;
                    option1.textContent = responsable;
                    selectResponsable.appendChild(option1);
                    
                    const option2 = document.createElement('option');
                    option2.value = responsable;
                    option2.textContent = responsable;
                    reportResponsable.appendChild(option2);
                });
            }

            function actualizarVista() {
                const listaPropuestas = document.getElementById('listaPropuestas');
                listaPropuestas.innerHTML = '';
                
                let tieneResultados = false;
                
                // Mostrar todas las áreas y factores
                areasData.forEach(area => {
                    // Si hay filtro de área y no coincide, saltar
                    if (filtroArea && area.id != filtroArea) return;
                    
                    const areaElement = document.createElement('div');
                    areaElement.className = 'area-section mb-5';
                    
                    const areaTitle = document.createElement('h2');
                    areaTitle.className = 'area-title';
                    areaTitle.textContent = `${area.id}. ${area.nombre}`;
                    areaElement.appendChild(areaTitle);
                    
                    let areaTieneContenido = false;
                    
                    // Mostrar todos los factores de esta área
                    area.factoresClave.forEach(factor => {
                        // Si hay filtro de factor y no coincide, saltar
                        if (filtroFactor && factor.id != filtroFactor) return;
                        
                        const factorElement = document.createElement('div');
                        factorElement.className = 'factor-section mb-4';
                        
                        const factorTitle = document.createElement('h3');
                        factorTitle.className = 'factor-title';
                        factorTitle.textContent = `${factor.id}. ${factor.nombre}`;
                        factorTitle.setAttribute('data-factor-id', factor.id);
                        factorTitle.addEventListener('click', function() {
                            mostrarElementosBueno(factor.id);
                        });
                        factorElement.appendChild(factorTitle);
                        
                        let factorTienePropuestas = false;
                        
                        // Mostrar propuestas de este factor
                        if (factor.propuestas.length > 0) {
                            factor.propuestas.forEach(propuesta => {
                                // Verificar si la propuesta coincide con los filtros
                                let coincideResponsable = !filtroResponsable;
                                let coincideEstado = !filtroEstado;
                                
                                if (filtroResponsable) {
                                    coincideResponsable = propuesta.indicadores.some(
                                        indicador => indicador.responsable === filtroResponsable
                                    );
                                }
                                
                                if (filtroEstado) {
                                    coincideEstado = propuesta.estado === filtroEstado;
                                }
                                
                                if (coincideResponsable && coincideEstado) {
                                    factorTienePropuestas = true;
                                    areaTieneContenido = true;
                                    tieneResultados = true;
                                    
                                    const propuestaElement = document.createElement('div');
                                    propuestaElement.className = 'propuesta-card';
                                    
                                    // ID de la propuesta
                                    const propuestaId = document.createElement('div');
                                    propuestaId.className = 'propuesta-id';
                                    propuestaId.textContent = `Propuesta ${propuesta.id}`;
                                    propuestaElement.appendChild(propuestaId);
                                    
                                    // Descripción de la propuesta
                                    const propuestaDesc = document.createElement('p');
                                    propuestaDesc.textContent = propuesta.descripcion;
                                    propuestaElement.appendChild(propuestaDesc);
                                    
                                    // Indicadores
                                    const indicadoresToggle = document.createElement('div');
                                    indicadoresToggle.className = 'indicadores-toggle';
                                    indicadoresToggle.textContent = 'Ver indicadores de evaluación';
                                    indicadoresToggle.addEventListener('click', function() {
                                        const indicadoresContainer = this.nextElementSibling;
                                        indicadoresContainer.classList.toggle('collapsed');
                                        this.textContent = indicadoresContainer.classList.contains('collapsed') 
                                            ? 'Ver indicadores de evaluación' 
                                            : 'Ocultar indicadores de evaluación';
                                    });
                                    propuestaElement.appendChild(indicadoresToggle);
                                    
                                    const indicadoresContainer = document.createElement('div');
                                    indicadoresContainer.className = 'indicadores-container collapsed';
                                    
                                    propuesta.indicadores.forEach(indicador => {
                                        const indicadorElement = document.createElement('div');
                                        indicadorElement.className = 'indicador-item';
                                        
                                        const indicadorDesc = document.createElement('p');
                                        indicadorDesc.textContent = indicador.descripcion;
                                        indicadorElement.appendChild(indicadorDesc);
                                        
                                        if (indicador.responsable) {
                                            const indicadorResponsable = document.createElement('p');
                                            indicadorResponsable.className = 'responsable';
                                            indicadorResponsable.textContent = `Responsable: ${indicador.responsable}`;
                                            indicadorElement.appendChild(indicadorResponsable);
                                        }
                                        
                                        indicadoresContainer.appendChild(indicadorElement);
                                    });
                                    
                                    propuestaElement.appendChild(indicadoresContainer);
                                    
                                    // Estado de la propuesta
                                    const estadoElement = document.createElement('div');
                                    estadoElement.className = 'estado-propuesta';
                                    
                                    const estadoLabel = document.createElement('h6');
                                    estadoLabel.textContent = 'Estado:';
                                    estadoElement.appendChild(estadoLabel);
                                    
                                    const estadoContainer = document.createElement('div');
                                    
                                    const estados = [
                                        { valor: 'no-iniciada', texto: 'No iniciada', clase: 'estado-no-iniciada' },
                                        { valor: 'en-proceso', texto: 'En proceso', clase: 'estado-en-proceso' },
                                        { valor: 'conseguida', texto: 'Conseguida', clase: 'estado-conseguida' }
                                    ];
                                    
                                    estados.forEach(estado => {
                                        const estadoDiv = document.createElement('div');
                                        estadoDiv.className = 'form-check form-check-inline';
                                        
                                        const input = document.createElement('input');
                                        input.className = 'form-check-input estado-check';
                                        input.type = 'radio';
                                        input.name = `estado-${propuesta.id}`;
                                        input.id = `estado-${propuesta.id}-${estado.valor}`;
                                        input.value = estado.valor;
                                        input.checked = propuesta.estado === estado.valor;
                                        
                                        input.addEventListener('change', function() {
                                            if (this.checked) {
                                                propuesta.estado = this.value;
                                                guardarEstados();
                                            }
                                        });
                                        
                                        const label = document.createElement('label');
                                        label.className = `form-check-label estado-label ${estado.clase}`;
                                        label.htmlFor = `estado-${propuesta.id}-${estado.valor}`;
                                        label.textContent = estado.texto;
                                        
                                        estadoDiv.appendChild(input);
                                        estadoDiv.appendChild(label);
                                        estadoContainer.appendChild(estadoDiv);
                                    });
                                    
                                    estadoElement.appendChild(estadoContainer);
                                    propuestaElement.appendChild(estadoElement);
                                    
                                    factorElement.appendChild(propuestaElement);
                                }
                            });
                        }
                        
                        // Si el factor no tiene propuestas pero se debe mostrar
                        if (!factorTienePropuestas && mostrarFactoresSinPropuestas && factor.propuestas.length === 0) {
                            areaTieneContenido = true;
                            tieneResultados = true;
                            
                            const sinPropuestas = document.createElement('p');
                            sinPropuestas.className = 'factor-sin-propuestas';
                            sinPropuestas.textContent = 'Este factor clave no tiene propuestas de mejora asociadas.';
                            factorElement.appendChild(sinPropuestas);
                        }
                        
                        // Solo añadir el factor si tiene contenido
                        if (factorTienePropuestas || (mostrarFactoresSinPropuestas && factor.propuestas.length === 0)) {
                            areaElement.appendChild(factorElement);
                        }
                    });
                    
                    // Solo añadir el área si tiene contenido
                    if (areaTieneContenido) {
                        listaPropuestas.appendChild(areaElement);
                    }
                });
                
                // Si no hay resultados, mostrar mensaje
                if (!tieneResultados) {
                    listaPropuestas.innerHTML = `
                        <div class="no-results">
                            <h3>No se encontraron propuestas con los filtros seleccionados</h3>
                            <p>Intenta ajustar los criterios de búsqueda</p>
                        </div>
                    `;
                }
            }

            function mostrarElementosBueno(factorId) {
                // Buscar el factor en los datos
                let factorEncontrado = null;
                
                areasData.forEach(area => {
                    area.factoresClave.forEach(factor => {
                        if (factor.id === factorId) {
                            factorEncontrado = factor;
                        }
                    });
                });
                
                if (!factorEncontrado) return;
                
                // Construir contenido del modal
                let modalContent = `
                    <h4>${factorEncontrado.id}. ${factorEncontrado.nombre}</h4>
                    <div class="table-responsive">
                        <table class="factores-table mt-3">
                            <thead>
                                <tr>
                                    <th>Elementos a considerar que describen el nivel "bueno" de logro</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                factorEncontrado.elementosBueno.forEach(elemento => {
                    modalContent += `
                        <tr>
                            <td>${elemento}</td>
                        </tr>
                    `;
                });
                
                modalContent += `
                            </tbody>
                        </table>
                    </div>
                `;
                
                // Actualizar el modal y mostrarlo
                document.getElementById('factoresModalBody').innerHTML = modalContent;
                const modal = new bootstrap.Modal(document.getElementById('factoresModal'));
                modal.show();
            }

            function guardarEstados() {
                const estados = {};
                
                areasData.forEach(area => {
                    area.factoresClave.forEach(factor => {
                        factor.propuestas.forEach(propuesta => {
                            estados[propuesta.id] = propuesta.estado;
                        });
                    });
                });
                
                localStorage.setItem('estadosPropuestas', JSON.stringify(estados));
            }

            function cargarEstados() {
                const estadosGuardados = localStorage.getItem('estadosPropuestas');
                
                if (estadosGuardados) {
                    const estados = JSON.parse(estadosGuardados);
                    
                    areasData.forEach(area => {
                        area.factoresClave.forEach(factor => {
                            factor.propuestas.forEach(propuesta => {
                                if (estados[propuesta.id]) {
                                    propuesta.estado = estados[propuesta.id];
                                }
                            });
                        });
                    });
                }
            }

            function exportarDatos() {
                const datosExportar = [];
                
                areasData.forEach(area => {
                    area.factoresClave.forEach(factor => {
                        factor.propuestas.forEach(propuesta => {
                            datosExportar.push({
                                codigo: propuesta.id,
                                estado: propuesta.estado,
                                contenido: propuesta.descripcion,
                                indicadores: propuesta.indicadores
                            });
                        });
                    });
                });
                
                const datosJSON = JSON.stringify(datosExportar, null, 2);
                const blob = new Blob([datosJSON], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = 'PlanDeMejora25_26_Datos.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }

            function importarDatos(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const datosImportados = JSON.parse(e.target.result);
                        
                        // Actualizar los estados y los indicadores de las propuestas
                        datosImportados.forEach(dato => {
                            areasData.forEach(area => {
                                area.factoresClave.forEach(factor => {
                                    factor.propuestas.forEach(propuesta => {
                                        if (propuesta.id === dato.codigo) {
                                            propuesta.estado = dato.estado;
                                            // Actualizar indicadores si están presentes en los datos importados
                                            if (dato.indicadores && Array.isArray(dato.indicadores)) {
                                                propuesta.indicadores = dato.indicadores;
                                            }
                                        }
                                    });
                                });
                            });
                        });
                        
                        // Volver a renderizar las propuestas
                        actualizarVista();
                        alert('Datos importados correctamente');
                    } catch (error) {
                        alert('Error al importar los datos: ' + error.message);
                    }
                };
                reader.readAsText(file);
                
                // Limpiar el input de archivo
                event.target.value = '';
            }

            async function guardarEnGist() {
                const token = document.getElementById('githubToken').value;
                if (!token) {
                    alert('Por favor, introduce un token de GitHub');
                    return;
                }
                
                const datosExportar = [];
                
                areasData.forEach(area => {
                    area.factoresClave.forEach(factor => {
                        factor.propuestas.forEach(propuesta => {
                            datosExportar.push({
                                codigo: propuesta.id,
                                estado: propuesta.estado,
                                contenido: propuesta.descripcion,
                                indicadores: propuesta.indicadores
                            });
                        });
                    });
                });
                
                const datosJSON = JSON.stringify(datosExportar, null, 2);
                
                try {
                    const response = await fetch('https://api.github.com/gists', {
                        method: 'POST',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            description: 'Plan de Mejora 2025-2026 - IES Virgen de Villadiego',
                            public: false,
                            files: {
                                'PlanDeMejora25_26_Datos.json': {
                                    content: datosJSON
                                }
                            }
                        })
                    });
                    
                    if (response.ok) {
                        const gist = await response.json();
                        alert('Datos guardados en GitHub Gist correctamente. ID: ' + gist.id);
                    } else {
                        throw new Error('Error al guardar en GitHub Gist: ' + response.statusText);
                    }
                } catch (error) {
                    alert('Error al guardar en GitHub Gist: ' + error.message);
                }
            }

            async function cargarDesdeGist() {
                const token = document.getElementById('githubToken').value;
                if (!token) {
                    alert('Por favor, introduce un token de GitHub');
                    return;
                }
                
                try {
                    const response = await fetch('https://api.github.com/gists', {
                        headers: {
                            'Authorization': `token ${token}`
                        }
                    });
                    
                    if (response.ok) {
                        const gists = await response.json();
                        mostrarGistsEnModal(gists);
                    } else {
                        throw new Error('Error al cargar la lista de Gists: ' + response.statusText);
                    }
                } catch (error) {
                    alert('Error al cargar la lista de Gists: ' + error.message);
                }
            }

            function mostrarGistsEnModal(gists) {
                const gistsList = document.getElementById('gistsList');
                gistsList.innerHTML = '';
                
                // Filtrar solo los gists que tienen el archivo PlanDeMejora25_26_Datos.json
                const gistsFiltrados = gists.filter(gist => 
                    gist.files && gist.files['PlanDeMejora25_26_Datos.json']
                );
                
                if (gistsFiltrados.length === 0) {
                    gistsList.innerHTML = '<p>No hay Gists con el archivo PlanDeMejora25_26_Datos.json</p>';
                } else {
                    gistsFiltrados.forEach(gist => {
                        const gistItem = document.createElement('div');
                        gistItem.className = 'gist-item';
                        
                        const fecha = new Date(gist.created_at).toLocaleDateString('es-ES');
                        const descripcion = gist.description || 'Sin descripción';
                        
                        gistItem.innerHTML = `
                            <h6>${descripcion}</h6>
                            <p class="mb-1">ID: ${gist.id}</p>
                            <p class="mb-1">Creado: ${fecha}</p>
                        `;
                        
                        gistItem.addEventListener('click', function() {
                            cargarDatosDesdeGist(gist.id);
                            const modal = bootstrap.Modal.getInstance(document.getElementById('gistsModal'));
                            modal.hide();
                        });
                        
                        gistsList.appendChild(gistItem);
                    });
                }
                
                // Mostrar el modal
                const modal = new bootstrap.Modal(document.getElementById('gistsModal'));
                modal.show();
            }

            async function cargarDatosDesdeGist(gistId) {
                const token = document.getElementById('githubToken').value;
                if (!token) {
                    alert('Por favor, introduce un token de GitHub');
                    return;
                }

                try {
                    const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                        headers: {
                            'Authorization': `token ${token}`
                        }
                    });

                    if (response.ok) {
                        const gist = await response.json();
                        const fileContent = gist.files['PlanDeMejora25_26_Datos.json'].content;
                        const datosImportados = JSON.parse(fileContent);

                        // Actualizar los estados y los indicadores de las propuestas
                        datosImportados.forEach(dato => {
                            areasData.forEach(area => {
                                area.factoresClave.forEach(factor => {
                                    factor.propuestas.forEach(propuesta => {
                                        if (propuesta.id === dato.codigo) {
                                            propuesta.estado = dato.estado;
                                            // Actualizar indicadores si están presentes en los datos importados
                                            if (dato.indicadores && Array.isArray(dato.indicadores)) {
                                                propuesta.indicadores = dato.indicadores;
                                            }
                                        }
                                    });
                                });
                            });
                        });

                        // Volver a renderizar las propuestas
                        actualizarVista();
                        alert('Datos cargados desde GitHub Gist correctamente');
                    } else {
                        throw new Error('Error al cargar desde GitHub Gist: ' + response.statusText);
                    }
                } catch (error) {
                    alert('Error al cargar desde GitHub Gist: ' + error.message);
                }
            }

            function generarPDFPorEstado() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Título y subtítulo
                doc.setFontSize(16);
                doc.setFont(undefined, 'bold');
                doc.text('IES VIRGEN DE VILLADIEGO - PLAN DE MEJORA', 105, 15, { align: 'center' });
                
                doc.setFontSize(12);
                doc.setFont(undefined, 'normal');
                doc.text('Curso 2025-2026', 105, 22, { align: 'center' });
                
                // Obtener estados seleccionados
                const estadosSeleccionados = [];
                if (document.getElementById('estadoNoIniciada').checked) estadosSeleccionados.push('no-iniciada');
                if (document.getElementById('estadoEnProceso').checked) estadosSeleccionados.push('en-proceso');
                if (document.getElementById('estadoConseguida').checked) estadosSeleccionados.push('conseguida');
                
                if (estadosSeleccionados.length === 0) {
                    alert('Por favor, selecciona al menos un estado');
                    return;
                }
                
                // Subtítulo del informe
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('INFORME POR ESTADO', 20, 35);
                
                // Descripción de estados seleccionados
                let descripcionEstados = 'Estados seleccionados: ';
                const nombresEstados = {
                    'no-iniciada': 'No iniciadas',
                    'en-proceso': 'En proceso',
                    'conseguida': 'Conseguidas'
                };
                
                descripcionEstados += estadosSeleccionados.map(estado => nombresEstados[estado]).join(', ');
                
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text(descripcionEstados, 20, 45);
                
                // Filtrar propuestas por estados seleccionados
                const propuestasPorEstado = [];
                
                areasData.forEach(area => {
                    area.factoresClave.forEach(factor => {
                        factor.propuestas.forEach(propuesta => {
                            if (estadosSeleccionados.includes(propuesta.estado)) {
                                propuestasPorEstado.push({
                                    area: area.nombre,
                                    factor: `${factor.id} - ${factor.nombre}`,
                                    propuesta: propuesta
                                });
                            }
                        });
                    });
                });
                
                let yPosition = 55;
                
                // Generar contenido para cada propuesta
                propuestasPorEstado.forEach(item => {
                    const estadoTexto = nombresEstados[item.propuesta.estado];
                    
                    // Verificar si necesitamos una nueva página
                    if (yPosition > 250) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    
                    // Número de orden de la propuesta
                    doc.setFontSize(11);
                    doc.setFont(undefined, 'bold');
                    doc.text(`Propuesta ${item.propuesta.id}`, 20, yPosition);
                    yPosition += 7;
                    
                    // Enunciado de la propuesta
                    doc.setFontSize(10);
                    doc.setFont(undefined, 'normal');
                    const descripcionLines = doc.splitTextToSize(item.propuesta.descripcion, 170);
                    doc.text(descripcionLines, 20, yPosition);
                    yPosition += (descripcionLines.length * 5) + 3;
                    
                    // Indicadores de evaluación
                    doc.setFontSize(10);
                    doc.setFont(undefined, 'bold');
                    doc.text('Indicadores de evaluación:', 20, yPosition);
                    yPosition += 6;
                    
                    item.propuesta.indicadores.forEach(indicador => {
                        // Verificar si necesitamos una nueva página para el indicador
                        if (yPosition > 270) {
                            doc.addPage();
                            yPosition = 20;
                        }
                        
                        // Descripción del indicador
                        doc.setFontSize(9);
                        doc.setFont(undefined, 'normal');
                        const indicadorLines = doc.splitTextToSize(`• ${indicador.descripcion}`, 165);
                        doc.text(indicadorLines, 25, yPosition);
                        yPosition += (indicadorLines.length * 4) + 2;
                        
                        // Responsable del indicador
                        doc.setFontSize(9);
                        doc.setFont(undefined, 'italic');
                        doc.text(`  Responsable: ${indicador.responsable}`, 25, yPosition);
                        yPosition += 5;
                    });
                    
                    // Espacio entre propuestas
                    yPosition += 8;
                    
                    // Línea separadora
                    if (yPosition < 280) {
                        doc.setDrawColor(200, 200, 200);
                        doc.line(20, yPosition, 190, yPosition);
                        yPosition += 10;
                    }
                });
                
                // Guardar PDF
                doc.save('informe_por_estado.pdf');
            }

            function generarPDFPorResponsable() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Título y subtítulo
                doc.setFontSize(16);
                doc.setFont(undefined, 'bold');
                doc.text('IES VIRGEN DE VILLADIEGO - PLAN DE MEJORA', 105, 15, { align: 'center' });
                
                doc.setFontSize(12);
                doc.setFont(undefined, 'normal');
                doc.text('Curso 2025-2026', 105, 22, { align: 'center' });
                
                // Obtener responsable seleccionado
                const responsableSeleccionado = document.getElementById('reportResponsable').value;
                
                if (!responsableSeleccionado) {
                    alert('Por favor, selecciona un responsable');
                    return;
                }
                
                // Subtítulo del informe
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('INFORME POR RESPONSABLE', 20, 35);
                
                // Descripción del responsable
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text(`Responsable: ${responsableSeleccionado}`, 20, 45);
                
                // Filtrar propuestas por responsable
                const propuestasPorResponsable = [];
                
                areasData.forEach(area => {
                    area.factoresClave.forEach(factor => {
                        factor.propuestas.forEach(propuesta => {
                            // Verificar si algún indicador tiene el responsable seleccionado
                            const tieneResponsable = propuesta.indicadores.some(
                                indicador => indicador.responsable === responsableSeleccionado
                            );
                            
                            if (tieneResponsable) {
                                propuestasPorResponsable.push({
                                    area: area.nombre,
                                    factor: `${factor.id} - ${factor.nombre}`,
                                    propuesta: propuesta
                                });
                            }
                        });
                    });
                });
                
                let yPosition = 55;
                
                // Generar contenido para cada propuesta
                propuestasPorResponsable.forEach(item => {
                    const nombresEstados = {
                        'no-iniciada': 'No iniciada',
                        'en-proceso': 'En proceso',
                        'conseguida': 'Conseguida'
                    };
                    const estadoTexto = nombresEstados[item.propuesta.estado];
                    
                    // Verificar si necesitamos una nueva página
                    if (yPosition > 250) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    
                    // Número de orden de la propuesta
                    doc.setFontSize(11);
                    doc.setFont(undefined, 'bold');
                    doc.text(`Propuesta ${item.propuesta.id}`, 20, yPosition);
                    yPosition += 7;
                    
                    // Estado de la propuesta
                    doc.setFontSize(10);
                    doc.setFont(undefined, 'bold');
                    doc.text(`Estado: ${estadoTexto}`, 20, yPosition);
                    yPosition += 6;
                    
                    // Enunciado de la propuesta
                    doc.setFontSize(10);
                    doc.setFont(undefined, 'normal');
                    const descripcionLines = doc.splitTextToSize(item.propuesta.descripcion, 170);
                    doc.text(descripcionLines, 20, yPosition);
                    yPosition += (descripcionLines.length * 5) + 3;
                    
                    // Indicadores de evaluación
                    doc.setFontSize(10);
                    doc.setFont(undefined, 'bold');
                    doc.text('Indicadores de evaluación:', 20, yPosition);
                    yPosition += 6;
                    
                    // Filtrar solo los indicadores del responsable seleccionado
                    const indicadoresDelResponsable = item.propuesta.indicadores.filter(
                        indicador => indicador.responsable === responsableSeleccionado
                    );
                    
                    indicadoresDelResponsable.forEach(indicador => {
                        // Verificar si necesitamos una nueva página para el indicador
                        if (yPosition > 270) {
                            doc.addPage();
                            yPosition = 20;
                        }
                        
                        // Descripción del indicador
                        doc.setFontSize(9);
                        doc.setFont(undefined, 'normal');
                        const indicadorLines = doc.splitTextToSize(`• ${indicador.descripcion}`, 165);
                        doc.text(indicadorLines, 25, yPosition);
                        yPosition += (indicadorLines.length * 4) + 2;
                    });
                    
                    // Espacio entre propuestas
                    yPosition += 8;
                    
                    // Línea separadora
                    if (yPosition < 280) {
                        doc.setDrawColor(200, 200, 200);
                        doc.line(20, yPosition, 190, yPosition);
                        yPosition += 10;
                    }
                });
                
                // Guardar PDF
                doc.save(`informe_por_responsable_${responsableSeleccionado.replace(/\s+/g, '_')}.pdf`);
            }

            // Retornar métodos públicos
            return {
                init: init
            };
        })();

        // Inicializar la aplicación cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', PlanDeMejoraApp.init);

        // Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registrado con éxito: ', registration.scope);
                    })
                    .catch(function(error) {
                        console.log('Error al registrar ServiceWorker: ', error);
                    });
            });
        }
    </script>
</body>
</html>